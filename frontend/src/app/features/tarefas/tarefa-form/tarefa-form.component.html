<div class="form-wrapper">
  <mat-card class="form-card">
    <mat-card-title>Nova Tarefa</mat-card-title>
    <mat-card-content>
      <form [formGroup]="form" (ngSubmit)="salvar()">
        <div class="grid">
          <mat-form-field appearance="outline">
            <mat-label>Projeto</mat-label>
            <mat-select formControlName="idProjeto" required>
              <mat-option [value]="null">Selecione...</mat-option>
              <mat-option *ngFor="let p of projetos" [value]="p.id">{{ p.nome }}</mat-option>
            </mat-select>
            <mat-error *ngIf="form.get('idProjeto')?.hasError('required')">Projeto é obrigatório</mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Título</mat-label>
            <input matInput formControlName="titulo" maxlength="100" required>
            <mat-hint align="end">{{ form.get('titulo')?.value?.length || 0 }}/100</mat-hint>
            <mat-error *ngIf="form.get('titulo')?.hasError('required')">Título é obrigatório</mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="full">
            <mat-label>Descrição</mat-label>
            <textarea matInput formControlName="descricao" rows="4" maxlength="500"></textarea>
            <mat-hint align="end">{{ form.get('descricao')?.value?.length || 0 }}/500</mat-hint>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Status</mat-label>
            <mat-select formControlName="status">
              <mat-option value="Aberta">Aberta</mat-option>
              <mat-option value="Em Progresso">Em Progresso</mat-option>
              <mat-option value="Concluída">Concluída</mat-option>
            </mat-select>
          </mat-form-field>
        </div>

        <div class="actions">
          <button mat-stroked-button type="button" (click)="cancelar()">Cancelar</button>
          <button mat-raised-button color="primary" type="submit" [disabled]="submitting">
            {{ submitting ? 'Salvando...' : 'Salvar' }}
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>
